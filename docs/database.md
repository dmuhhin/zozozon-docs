# Структура базы данных

## Основная база данных: `bosch`
Описание всех таблиц, используемых в системе, их полей и связей между ними.

---

### 1. Таблица `bosch`
**Описание:** Основные товары (Bosch).
- `id` — уникальный идентификатор товара
- `sku` — артикул товара (используется как основной ключ для связей)
- `name` — название товара
- `brand` — бренд
- `price` — цена продажи
- `weight` — вес товара
- `taxable` — подлежит ли налогообложению

### 2. Таблица `bosch_acc`
**Описание:** Аксессуары Bosch.
- `id`
- `sku`
- `name`
- `related_sku` — связанный товар (из `bosch`)

### 3. Таблица `bosch_parts`
**Описание:** Запасные части Bosch.
- `id`
- `sku`
- `part_name`
- `parent_sku` — артикул основного устройства

### 4. Таблица `details`
**Описание:** Дополнительные параметры товара.
- `sku`
- `dimensions` — размеры (в мм)
- `color`
- `material`
- `power` — мощность (если применимо)

### 5. Таблица `images`
**Описание:** Изображения товаров.
- `sku`
- `url` — ссылка на изображение
- `is_placeholder` — является ли изображение заглушкой

### 6. Таблица `orders`
**Описание:** Все заказы, полученные из различных источников.
- `order_id`
- `sku`
- `quantity`
- `price_at_sale`
- `platform` — источник (например, `eBay`, `Shopify`, и т.д.)
- `fulfillment_status`

### 7. Таблица `platforms`
**Описание:** Источники заказов и их параметры.
- `platform_id`
- `name`
- `api_url`
- `auth_token`

### 8. Таблица `sellbrite`
**Описание:** Данные из Sellbrite.
- `sku`
- `title`
- `description`
- `price`
- `stock`

---

## Виртуальные таблицы (представления)

### `v_prod_rus`
- Объединяет товары с переводами и параметрами для отображения в Shopify и eBay.

### `v_products`
- Основной список всех товаров с актуальными остатками и ценами.

### `v_reserved`
- Расчёт текущих резервов (на основании неотгруженных заказов).

### `v_stat`
- Ежедневная статистика продаж, по платформам и по брендам.

### `xml_diff`
- Изменения, которые необходимо передать в XML-фиды для синхронизации с платформами (например, Google Merchant Center).

---

## Связи между таблицами
- `sku` — основной ключ во всех таблицах.
- `bosch_parts.parent_sku` → `bosch.sku`
- `bosch_acc.related_sku` → `bosch.sku`
- `orders.sku` → `v_products.sku`
- `images.sku` → `bosch/bosch_parts/bosch_acc`

---

## Примечания
- Поля могут дополняться в зависимости от поставщика (Makita, Bosch и т.д.).
- Для фильтрации placeholder-изображений используется `is_placeholder = true`.
- Цены могут рассчитываться на основе таблицы `fullprice` и скриптов в `pricer`.